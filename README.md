# Volzhanin ESP32
## Этапы сварки: 
 1. Оплавление
 2. Прогрев
 3. Тех.пауза
 4. Осадка
 5. Сварка
 6. Сварка с пониженным давлением
## Протокол обмена

### Service ID 67a4eeb9-98f1-4186-8717-df670471d68b Архив
Функция **READ** чтение архивов с текущего этапа arch_state.
Возвращает архивы сварки каждого отдельного этапа: 23.5;23.5;12.5;34.5;12.8;...34.6
Функция **WRITE** запись параметров для чтения архивов offset - смещение, arch_state - архив конкретного этапа.

Пример команды: {"offset":0,"arch_state":1}
Команда стереть все архивы: {"offset":0,"arch_state":0}

### Service ID 4e75c6fe-d008-49f2-b182-fe231eed747c Сварка
Функция **READ** чтение текущих параметров сварки welding_param.
Возвращает текущие параметры сварки: 123456789;106;25;106;0;31.8;900;1800;40;9600;49;123456789;823456789

Функция **WRITE** запись параметров сварки и старт процесса.
Примеры команд: 
{cmd:0, st_n:5, sp_p:[106,25,106,47,31.8,12], st_t:[900,1800,40,9600,49,10], ts:123456789, id:"12345678"}, где cmd:0 - параметр для записи параметров сварки, sp_p - уставки давлений каждого этапа, st_n - количество этапов сварки, st_t - время длительности каждого этапа в секундах, ts - время начала сварки UTC, id - уникальный ID сварки.
{cmd:1, state:1}, cmd:1 - параметр для перехода на следующий этап, state:1 - этап сварки
{cmd:2, sensors: {p_out_min:0, p_out_max:16, p_in_min:4, p_in_max:20}}, cmd:2 - параметры настройки датчиков
{cmd:3, update:1}, cmd:3 - параметр для включения wifi для обновления прошивки

Функция **NOTIFY** подписаться на уведомления от устройства.
 - Возвращает текущий этап сварки
 - Текущее время этапа
 - Оповещения о выходе параметров за пределы - массив из 4 типов параметров оповещения: 1-давление вне диапазона, 2-20 секунд до окончания этапы, 3-низкий заряд батареи, 4-низкая температур окр. среды
 - Давление
 - Напряжение батареи 
 - Температуру окружающей среды.
Пример сообщения: 1;45;0;0;0;0;23.5;4.2;12.1
